!function(e){"use strict";var t=new function(){function e(){n.controlVars.update.finish=!0;var e=(new Date).getTime();n.time.miliseconds=e,n.time.interval=setInterval(function(){if(n.controlVars.update.finish){n.controlVars.update.finish=!1,n.controlVars.update.alerted=!1,n.controlVars.update.exceeded=0;var e=(new Date).getTime(),t=e-n.time.miliseconds;n.time.elapsedTime+=t,n.time.deltaTime=t/1e3*n.time.speed,n.time.miliseconds=e,n.time.FPS=1/n.time.deltaTime,n.time.FPSsum+=n.time.FPS,n.time.FPScount++,i()}else n.controlVars.update.exceeded++,n.time.lossedFrames++,n.controlVars.update.exceeded>=n.controlVars.update.alert&&($d.LogWarning("Loosing frames, consider using a lower maxFPS("+n.time.FPS+") value or reivew your code."),n.controlVars.update.alerted=!0)},1e3/n.time.maxFPS)}function i(){try{n.user.udpate()}catch(e){$d.LogError("Error in User Update function",e)}s(),r(),o(),n.controlVars.update.finish=!0}function o(){n.ctx.font="12px Arial",n.ctx.fillStyle="#000",n.ctx.fillText("FPS: "+Math.ceil(n.time.FPSsum/n.time.FPScount),10,10)}function s(){for(var e,t,i=0;i<n.phycs.length;i++)e=n.phycs[i],t=e.force.x,e.pos.x+=t/e.mass*n.time.deltaTime,t=e.force.y,e.pos.y+=t/e.mass*n.time.deltaTime,0==e.forceType&&(e.force.x>0?e.force.x-=e.drag*n.time.deltaTime:e.force.x=0,Math.abs(e.force.y)<n.globals.maxForce?e.force.y-=n.world.gravity*n.time.deltaTime:e.force.y=n.globals.maxForce*(e.force.y<0?-1:1)),e.pos.y<0&&(e.pos.y=0,e.force.y=-e.force.y*e.bounce)}function r(){n.ctx.globalAlpha=n.globals.opacity,n.ctx.fillStyle=n.globals.background,n.ctx.fillRect(0,0,n.size.x,n.size.y),n.ctx.globalAlpha=1;for(var e=0;e<n.layers.length;e++)for(var t=0;t<n.layers[e].length;t++)a(n.layers[e][t])}function a(e){n.debug&&(n.ctx.fillStyle=e.color,n.ctx.fillRect(e.pos.x,n.size.y-e.pos.y,10,10))}var n={debug:!0,started:!1,canvas:"",ctx:"",size:0,time:{FPS:1,FPScount:0,FPSsum:0,lossedFrames:0,maxFPS:60,deltaTime:1,startTime:0,elapsedTime:0,miliseconds:0,speed:1},controlVars:{update:{finish:!1,exceeded:0,alert:50,alerted:!1},start:!1},world:{gravity:10,drag:1},globals:{maxForce:150,opacity:.7,background:"#FFF"},layers:[],phycs:[],user:{}};this.init=function(t,i,o){if(n.started)$d.LogWarning("The engine is already running!");else if(void 0!=t&&"object"==typeof t)if("function"==typeof i&&"function"==typeof o)try{n.ctx=t.getContext("2d"),n.size=new this.Vector2(0,0),n.size.x=t.width,n.size.y=t.height,n.user.start=i,n.user.udpate=o,e(),n.started=!0}catch(s){$d.LogError("The element is not a canvas")}else $d.LogError("Missing Start/Update functions");else $d.LogError("Invalid element")},this.setMaxFPS=function(e){"number"==typeof e?n.time.maxFPS=e:$d.LogError("Invalid value")},this.setDebug=function(e){"boolean"==typeof e?n.debug=e:$d.LogError("Invalid value")},this.setSpeed=function(e){"number"==typeof e?n.time.speed=e:$d.LogError("Invalid value")},this.stats=function(){$d.Log("STATS"),$d.Log("FPS: "+n.time.FPS),$d.Log("Current state: "+(n.started?"Running":"Stopped")),$d.Log("Frame loss count: "+n.time.lossedFrames),$d.Log("Elapsed Time: "+$d.FormatMiliseconds(n.time.elapsedTime)),$d.Stats()},this.add2DObject=function(e,t){var i=n.phycs.push(e);void 0==n.layers[t+50]&&(n.layers[t+50]=[]),n.layers[t+50].push(n.phycs[i-1])},this.Vector2=function(e,t){this.x=e,this.y=t},this.Object2D=function(e,i,o,s,r,a){this.name=e,this.pos=new t.Vector2(i,o),this.kinematic=0==s,this.mass=s,this.drag=r,this.bounce=a,this.force=new t.Vector2(0,0),this.forceType=0,this.color="#000",this.addForce=function(e,t,i){this.force.x+=e,this.force.y+=t,this.forceType=void 0==i?0:i}}};e.$e=t}(window);
//# sourceMappingURL=core.min.js.map