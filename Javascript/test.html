<html>
    <head>
        <script src="src/loader.min.js"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function(event) { 
                $loader.addscripts([
                    new $loader.script("Common", "http://cdn.driconmax.com.ar/DEngine/master/Javascript/src/common.js"),
                    new $loader.script("Core", "http://cdn.driconmax.com.ar/DEngine/master/Javascript/src/core.js")
                ]);
                $loader.start();
                $loader.onstart = function(r){
                    console.log("Downloading " + r.totalbytes + " bytes");
                }
                $loader.onprogresschange = function(p){
                    console.log("["+p.current.fileindex+"/"+p.totalfiles+"] Loading " + p.current.name + " v" + ((p.current.version)?p.current.version:"") +"\t - \t" + p.progress + "%");
                };
                $loader.onload = function(){
                    //If the download went correctly, we should be able to use the common library ($d).
                    $d.Log("Load complete");

                    $e.init(document.getElementById("mainCanvas"), function(){}, function(){})
                    oneObject();
                    //newtonian();

                }
            });
            function oneObject(){
                var obj = new $e.Object2D("Object", 20, 60, 1, 1, 0.9);
                obj.addForce(30,10);
                obj.setCollider(new $e.BoxCollider(20,20));
                obj.rotation = 45;
                $e.add2DObject(obj, -50);
                var obj2 = new $e.Object2D("Floor", 350, 10, 0, 0, 0.9);
                obj2.addForce(0,0);
                obj2.setCollider(new $e.BoxCollider(700,20));
                obj2.rotation = 0;
                $e.add2DObject(obj2, -50);
                var obj5 = new $e.Object2D("Roof", 350, 140, 0, 0, 0.9);
                obj5.addForce(0,0);
                obj5.setCollider(new $e.BoxCollider(700,20));
                obj5.rotation = 0;
                $e.add2DObject(obj5, -50);
                var obj3 = new $e.Object2D("WallL", 690, 75, 0, 0, 0.9);
                obj3.addForce(0,0);
                obj3.setCollider(new $e.BoxCollider(150,20));
                obj3.rotation = 90;
                $e.add2DObject(obj3, -50);
                var obj4 = new $e.Object2D("WallR", 10, 75, 0, 0, 0.9);
                obj4.addForce(0,0);
                obj4.setCollider(new $e.BoxCollider(150,20));
                obj4.rotation = 90;
                $e.add2DObject(obj4, -50);
                $e.addDebugObject("OBJ P", obj, ["pos"]);
                $e.addDebugObject("OBJ V", obj, ["velocity"]);
            }
            function newtonian(){
                $e.setGravity(0);
                for(var i = 0; i < 10; i++){
                    var obj = new $e.Object2D("Object", Math.random()*800, Math.random()*800, Math.random()*80, 1, 0.9);
                    obj.addForce(Math.random()*10-5,Math.random()*10-5);
                    obj.setCollider(new $e.BoxCollider(20,20));
                    obj.newtonian = true;
                    $e.add2DObject(obj, -50);
                }
            }
        </script>
    </head>

    <body>
        <canvas id="mainCanvas" width="800" height="800"></canvas>
    </body>
</html>
